import{g as U,q as C,u as Y,i as L,O as N,_ as B,c as I,w as q,e as D,r as d,o as p,a as t,t as E,m as M,d as b,b as s,n as de,I as G,z as ie,Q as re,R as O,S as _e,T as k,K as P,U as J,V as K,x as z,h as ne,W as Z,X as H,Y as ue,L as Q,Z as me,$ as pe,s as W,l as j,f as fe,a0 as ve,a1 as he,a2 as we}from"../index25247.js";import{C as ye,a as ge}from"./CardProductRequestAgenda25247.js";import"./AppointmentCalendar25247.js";const qe={props:{sources:Array,modelValue:{type:Object,default:()=>({})}},setup(v,{emit:o}){const _=U(()=>JSON.parse(JSON.stringify(m.getters[N.CURRENT_PRODUCT_REQUEST]))),e=U({get:()=>v.modelValue,set:r=>o("update:modelValue",r)}),i=C([{name:"Gi\xE0 cliente",code:"NY"},{name:"Facebook",code:"RM"}]),m=Y();return{types:i,moment:L,product_request:_,new_product_request:e}}};const be={class:"flex justify-content-between align-items-center"},Te={class:"flex"},Ce={class:"flex flex-column mr-6"},Re=t("label",{class:"custom-label mb-2"},"Numero pratica",-1),Ve={class:"text-color-secondary mr-5"},De={class:"flex flex-column mr-6"},Ue=t("label",{class:"custom-label mb-2"},"Data creazione",-1),Ee={class:"text-400"},xe={key:0},Se={class:"flex flex-column custom-dropdown"},Pe={class:"field mb-0 flex flex-column"},Ae=t("label",{for:"request_type",class:"custom-label mb-2"},"Fonte",-1),Oe={key:1,class:"capitalize"},Ne={key:0};function Ie(v,o,_,e,i,m){const r=d("Dropdown"),n=d("Chip"),l=d("Card");return e.product_request.id?(p(),I(l,{key:0},{content:q(()=>[t("div",be,[t("div",Te,[t("div",Ce,[Re,t("b",Ve,E(e.product_request.number),1)]),t("div",De,[Ue,t("span",Ee,[M(" Del "),e.product_request.created_at!=null?(p(),b("span",xe,E(e.moment.unix(e.product_request.created_at).format("DD/MM/YYYY")),1)):D("",!0)])]),t("div",Se,[t("div",Pe,[Ae,e.product_request.source?(p(),b("span",Oe,E(e.new_product_request.source),1)):(p(),I(r,{key:0,modelValue:e.new_product_request.source,"onUpdate:modelValue":o[0]||(o[0]=u=>e.new_product_request.source=u),options:_.sources,id:"request_type",class:"dropdown"},null,8,["modelValue","options"]))])])]),e.product_request.request_status?(p(),b("div",Ne,[s(n,{style:de({backgroundColor:e.product_request.request_status.bg_color,color:e.product_request.request_status.color})},{default:q(()=>[M(E(e.product_request.request_status.main_request_status_name),1)]),_:1},8,["style"])])):D("",!0)])]),_:1})):D("",!0)}const ae=B(qe,[["render",Ie]]),ke={props:{product_types:Array},setup(){const v=U(()=>_.getters[N.CURRENT_PRODUCT_REQUEST]),o=C(!1),_=Y(),e=G(),i=ie({product_type:null,contact_job_note:"",expiration_date:"",montly_amount:"",company_name:"",contact_id:v.value?v.value.contact_id:""}),m=()=>{o.value=!0},r=()=>{o.value=!1,n()},n=async function(){await _.dispatch(re.CREATE_PRODUCT,i).then(()=>{O(e,{message:"Prodotto salvato correttamente.",title:""});let u=_.getters[_e.CURRENT_PRODUCT];_.dispatch(k.ADD_PRDODUCT_TO_REQUEST,u),l()}).catch(u=>{P(e,u)})},l=function(){i.product_type=null,i.contact_job_note="",i.expiration_date="",i.montly_amount="",i.company_name=""};return{request_detail:v,displayDialog:o,new_product:i,moment:L,openAddProductDialog:m,closeDialog:r}},components:{CardSingleProduct:ye}},Me={class:"card-product"},je={class:"flex justify-content-between align-items-center"},Le=t("h2",null,"ALTRI PRODOTTI",-1),Qe={class:"formgrid grid pt-0"},Ye={class:"field col-12"},Be=t("label",{for:"product_type"},"Tipologia prodotto",-1),Fe={class:"field col-6"},ze=t("label",{for:"company_name"},"Competitor",-1),Ge={class:"field col-6"},Ze=t("label",{for:"amount"},"Importo mensile*",-1),He={class:"field col-6"},Je=t("label",{for:"expiration_date"},"Data scadenza*",-1),Ke={class:"field col-12"},We=t("label",{for:"note"},"Note",-1),Xe={key:0,class:"flex justify-content-between column-gap-2 row-gap-4 flex-wrap mt-4"},$e={key:1},et=t("label",null,"Nessun prodotto esistente",-1),tt=[et];function ot(v,o,_,e,i,m){const r=d("Button"),n=d("Dropdown"),l=d("InputText"),u=d("InputMask"),w=d("Textarea"),T=d("Dialog"),h=d("CardSingleProduct"),R=d("Card"),x=d("ConfirmPopup");return p(),b("div",Me,[s(R,{class:"mt-3"},{content:q(()=>[t("div",je,[Le,s(r,{label:"Aggiungi Prodotto",onClick:e.openAddProductDialog,class:"p-button-outlined"},null,8,["onClick"]),s(T,{header:"AGGIUNGI PRODOTTO",visible:e.displayDialog,"onUpdate:visible":o[5]||(o[5]=a=>e.displayDialog=a),breakpoints:{"960px":"50vw","640px":"90vw"},style:{width:"35vw"},modal:!0},{footer:q(()=>[s(r,{label:"SALVA PRODOTTO",onClick:e.closeDialog,autofocus:""},null,8,["onClick"])]),default:q(()=>[t("div",Qe,[t("div",Ye,[Be,s(n,{modelValue:e.new_product.product_type,"onUpdate:modelValue":o[0]||(o[0]=a=>e.new_product.product_type=a),options:_.product_types,id:"product_type",class:"w-full"},null,8,["modelValue","options"])]),t("div",Fe,[ze,s(l,{class:"w-full",id:"company_name",type:"text",modelValue:e.new_product.company_name,"onUpdate:modelValue":o[1]||(o[1]=a=>e.new_product.company_name=a)},null,8,["modelValue"])]),t("div",Ge,[Ze,s(l,{class:"w-full",id:"montly_amount",type:"text",modelValue:e.new_product.montly_amount,"onUpdate:modelValue":o[2]||(o[2]=a=>e.new_product.montly_amount=a)},null,8,["modelValue"])]),t("div",He,[Je,s(u,{id:"expiration_date",mask:"99/99/9999",modelValue:e.new_product.expiration_date,"onUpdate:modelValue":o[3]||(o[3]=a=>e.new_product.expiration_date=a),placeholder:"gg/mm/aaaa",slotChar:"gg/mm/aaaa",class:"w-full"},null,8,["modelValue"])]),t("div",Ke,[We,s(w,{id:"note",modelValue:e.new_product.notes,"onUpdate:modelValue":o[4]||(o[4]=a=>e.new_product.notes=a),rows:"5",cols:"30",class:"w-full"},null,8,["modelValue"])])])]),_:1},8,["visible"])]),e.request_detail&&e.request_detail.products&&e.request_detail.products.length>0?(p(),b("div",Xe,[(p(!0),b(J,null,K(e.request_detail.products,a=>(p(),I(h,{key:a.id,product:a,icon_delete:!0},null,8,["product"]))),128))])):D("",!0),e.request_detail.products==null||e.request_detail.products.length==0?(p(),b("div",$e,tt)):D("",!0)]),_:1}),s(x)])}const nt=B(ke,[["render",ot]]),at={setup(){const v=Y(),o=G(),_=C({request_status:{name:"",id:""},request_status_id:"",note:""}),e=C([]),i=C(),m=C({}),r=U(()=>v.getters[H.CURRENT_REQUEST_STATUSES]);U(()=>v.getters[H.CURRENT_REQUEST_STATUS]);const n=U(()=>v.getters[N.CURRENT_PRODUCT_REQUEST]),l=U(()=>v.getters[H.CURRENT_REQUEST_STATUS_HISTORY]),u=async function(){try{return await v.dispatch(Z.FETCH_ALL_PRODUCTS_REQUEST)}catch(a){P(o,a)}},w=a=>{let{newData:y,index:g}=a;h(y)},T=async function(){let a=n.value.id+"",g={request_history:{request_status_id:_.value.request_status.id+"",note:_.value.note,product_request_id:a}};await v.dispatch(Z.ADD_STATUS_TO_REQUEST,g).then(()=>{O(o,{message:"Stato pratica salvato correttamente.",title:""}),i.value&&(i.value.product_request_status_histories=l.value),R()}).catch(A=>{P(o,A)})},h=async function(a){m.value;let y={request_history:{request_status_id:m.value.id,note:a.note,product_request_id:a.id}};await v.dispatch(Z.UPDATE_REQUEST_STATUS,y).then(()=>{O(o,{message:"Stato pratica salvato correttamente.",title:""}),i.value&&(i.value.product_request_status_histories=l.value),R()}).catch(g=>{P(o,g)})},R=function(){_.value.request_status={name:"",id:""},_.value.note="",_.value.request_status_id=""},x=function(a){if(!(m.value&&m.value.id))for(let y of r.value)for(let g of y.children)g.name===a&&(m.value=g)};return z(n,a=>{i.value=Object.assign({},a),i.value.product_request_status_histories=Object.assign([],a.product_request_status_histories)}),ne(async()=>{u(),i.value=Object.assign({},n.value),i.value.product_request_status_histories=Object.assign([],n.value.product_request_status_histories)}),{new_status:_,requests_status:r,new_request_detail:i,moment:L,editingRows:e,preselect_dropdown:m,createRequestStatus:T,onRowEditSave:w,findValueSelect:x}}};const st=t("h2",{class:"mt-0 mb-3"},"STATI PRATICA",-1),lt={class:"formgrid grid"},ct={class:"field col-5"},dt=t("label",{for:"product_type"},"Nuovo stato pratica",-1),it={class:"field col-5"},rt=t("label",{for:"note"},"Testo",-1),_t={class:"field col-2 mb-4 mt-4 flex justify-content-end"};function ut(v,o,_,e,i,m){const r=d("Dropdown"),n=d("Textarea"),l=d("Button"),u=d("Column"),w=d("DataTable"),T=d("Card");return p(),I(T,{class:"mt-3"},{content:q(()=>[st,t("div",lt,[t("div",ct,[dt,e.requests_status?(p(),I(r,{key:0,options:e.requests_status,id:"product_type",class:"w-full",optionLabel:"name",optionGroupLabel:"name",optionGroupChildren:"children",modelValue:e.new_status.request_status,"onUpdate:modelValue":o[0]||(o[0]=h=>e.new_status.request_status=h)},null,8,["options","modelValue"])):D("",!0)]),t("div",it,[rt,s(n,{class:"w-full",id:"note",rows:"5",cols:"30",modelValue:e.new_status.note,"onUpdate:modelValue":o[1]||(o[1]=h=>e.new_status.note=h)},null,8,["modelValue"])]),t("div",_t,[s(l,{label:"Aggiungi stato",onClick:e.createRequestStatus,class:"add-status p-button-outlined"},null,8,["onClick"])])]),e.new_request_detail?(p(),I(w,{key:0,value:e.new_request_detail.product_request_status_histories,responsiveLayout:"scroll",editMode:"row",dataKey:"id",editingRows:e.editingRows,"onUpdate:editingRows":o[3]||(o[3]=h=>e.editingRows=h),onRowEditSave:e.onRowEditSave,class:"request-status-table"},{empty:q(()=>[M(" Nessuno stato inserito. ")]),default:q(()=>[s(u,{field:"date",header:"Data e ora",style:{"min-width":"11rem"}},{body:q(({data:h})=>[M(E(e.moment.unix(h.created_at).format("DD/MM/YYYY - HH:mm")),1)]),_:1}),s(u,{field:"request_status_name",header:"Stato pratica",style:{"min-width":"15rem"}},{editor:q(({data:h})=>[s(r,{options:e.requests_status,id:"product_type",class:"w-full",optionLabel:"name",optionGroupLabel:"name",optionGroupChildren:"children",value:e.findValueSelect(h.request_status_name),modelValue:e.preselect_dropdown,"onUpdate:modelValue":o[2]||(o[2]=R=>e.preselect_dropdown=R)},null,8,["options","value","modelValue"])]),body:q(h=>[M(E(h.data.request_status_name.name||h.data.request_status_name),1)]),_:1}),s(u,{field:"note",header:"Testo"},{editor:q(({data:h,field:R})=>[s(n,{class:"w-full",id:"note",rows:"5",cols:"30",modelValue:h[R],"onUpdate:modelValue":x=>h[R]=x},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),s(u,{field:"created_by_full_name",header:"Operatore",style:{"min-width":"14rem"}}),s(u,{rowEditor:!0,style:{width:"10%","min-width":"8rem"},bodyStyle:"text-align:center"})]),_:1},8,["value","editingRows","onRowEditSave"])):D("",!0)]),_:1})}const mt=B(at,[["render",ut]]),pt={props:{initProductRequest:{type:Object,default:()=>({})},modelValue:{type:Object,default:()=>({})}},setup(v,{emit:o}){const _=U(()=>JSON.parse(JSON.stringify(i.getters[N.CURRENT_PRODUCT_REQUEST]))),e=U({get:()=>v.modelValue,set:l=>o("update:modelValue",l)}),i=Y(),m=C(!1),r=C(v.initProductRequest),n=function(){var l,u,w;return e.value.id==""||e.value.id==null?!1:(((l=e.value)==null?void 0:l.amount)==""||((u=e.value)==null?void 0:u.amount)==null||((w=e.value)==null?void 0:w.amount)==null?m.value=!0:m.value=!1,m.value)};return z(_,l=>{e.value=Object.assign({},l)}),z(r,l=>{r.value=Object.assign({},l)}),{moment:L,new_product_request:e,invalid_amount:m,validateAmount:n}},components:{CardProducts:nt,CardProductRequestStatus:mt,CardProductRequestDetail:ae,CardProductRequestAgenda:ge}};const ft={class:"flex"},vt={class:"formgrid grid flex-column col-6 pl-0"},ht=t("div",{class:"col-12"},[t("h2",{class:"m-0 mb-3"},"INFORMAZIONI PRATICA")],-1),wt={class:"field col-8"},yt=t("label",{for:"request_type"},"Tipo di richiesta",-1),gt={class:"field col-8"},qt=t("label",{for:"amount"},"Importo richiesta (\u20AC)*",-1),bt={key:0,id:"amount",class:"p-error"},Tt={class:"formgrid grid col-6"},Ct=t("div",{class:"col-12"},[t("h2",{class:"m-0 mb-3"},"PRATICA APPROVATA")],-1),Rt={class:"field col-6"},Vt=t("label",{for:"pitagora_code"},"Codice pitagora",-1),Dt=t("div",{class:"col-6"},null,-1),Ut={class:"field col-6"},Et=t("label",{for:"start_at"},"Data inizio",-1),xt={class:"field col-6"},St=t("label",{for:"end_at"},"Data fine",-1),Pt={class:"field col-6"},At=t("label",{for:"duration"},"Durata (in mesi)",-1),Ot={class:"field col-6"},Nt=t("label",{for:"montly_amount"},"Importo rata (\u20AC)",-1);function It(v,o,_,e,i,m){const r=d("CardProductRequestDetail"),n=d("Dropdown"),l=d("InputText"),u=d("InputMask"),w=d("Card"),T=d("CardProductRequestAgenda"),h=d("CardProducts"),R=d("CardProductRequestStatus"),x=me("disable-all");return e.new_product_request?ue((p(),b("div",{key:0,class:Q(["tab-informations",{disabledTab:!e.new_product_request.id}])},[s(r,{sources:_.initProductRequest.sources,modelValue:e.new_product_request,"onUpdate:modelValue":o[0]||(o[0]=a=>e.new_product_request=a)},null,8,["sources","modelValue"]),s(w,{class:"mt-3"},{content:q(()=>[t("div",ft,[t("div",vt,[ht,t("div",wt,[yt,s(n,{modelValue:e.new_product_request.product_type,"onUpdate:modelValue":o[1]||(o[1]=a=>e.new_product_request.product_type=a),options:_.initProductRequest.product_request_types,id:"request_type",class:"w-full"},null,8,["modelValue","options"])]),t("div",gt,[qt,s(l,{class:Q(["w-full",{"p-invalid":e.invalid_amount}]),id:"amount",type:"text",modelValue:e.new_product_request.amount,"onUpdate:modelValue":o[2]||(o[2]=a=>e.new_product_request.amount=a),onChange:e.validateAmount},null,8,["class","modelValue","onChange"]),e.invalid_amount?(p(),b("small",bt,"Campo obbligatorio.")):D("",!0)])]),t("div",Tt,[Ct,t("div",Rt,[Vt,s(l,{id:"pitagora_code",type:"text",modelValue:e.new_product_request.pitagora_code,"onUpdate:modelValue":o[3]||(o[3]=a=>e.new_product_request.pitagora_code=a),class:"w-full"},null,8,["modelValue"])]),Dt,t("div",Ut,[Et,s(u,{id:"start_at",mask:"99/99/9999",modelValue:e.new_product_request.start_at,"onUpdate:modelValue":o[4]||(o[4]=a=>e.new_product_request.start_at=a),placeholder:"gg/mm/aaaa",slotChar:"gg/mm/aaaa",class:"w-full"},null,8,["modelValue"])]),t("div",xt,[St,s(u,{id:"end_at",mask:"99/99/9999",modelValue:e.new_product_request.end_at,"onUpdate:modelValue":o[5]||(o[5]=a=>e.new_product_request.end_at=a),placeholder:"gg/mm/aaaa",slotChar:"gg/mm/aaaa",class:"w-full"},null,8,["modelValue"])]),t("div",Pt,[At,s(l,{id:"duration",type:"text",modelValue:e.new_product_request.duration,"onUpdate:modelValue":o[6]||(o[6]=a=>e.new_product_request.duration=a),class:"w-full"},null,8,["modelValue"])]),t("div",Ot,[Nt,s(l,{class:"w-full",id:"montly_amount",type:"text",modelValue:e.new_product_request.montly_amount,"onUpdate:modelValue":o[7]||(o[7]=a=>e.new_product_request.montly_amount=a)},null,8,["modelValue"])])])])]),_:1}),s(T,{modelValue:e.new_product_request,"onUpdate:modelValue":o[8]||(o[8]=a=>e.new_product_request=a)},null,8,["modelValue"]),s(h,{product_types:_.initProductRequest.product_request_types},null,8,["product_types"]),s(R)],2)),[[x,!e.new_product_request.id]]):D("",!0)}const kt=B(pt,[["render",It]]),Mt={props:{title:String,genericDocuments:Array,documents_type:String,modelValue:{type:Object,default:()=>({})}},setup(v,{emit:o}){const _=U(()=>m.getters[N.CURRENT_PRODUCT_REQUEST]),e=U({get:()=>v.modelValue,set:a=>o("update:modelValue",a)}),i=G(),m=Y(),r=pe(),n=C(new Array),l=a=>{n.value=a.files},u=a=>{if(a===0)return"0 B";let y=1e3,g=3,A=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],S=Math.floor(Math.log(a)/Math.log(y));return parseFloat((a/Math.pow(y,S)).toFixed(g))+" "+A[S]},w=async function(a){let y={request_id:_.value.id,attachment_id:a};try{const g=await m.dispatch(k.DELETE_PRODUCT_REQUEST_DOCUMENT,y);return O(i,{message:"Documento eliminato correttamente.",title:""}),g}catch(g){j(m),P(i,g)}};return{product_request:_,documents:n,onRemoveTempDocument:function(a,y){e.value.splice(a,1)},uploadDocuments:async function(a,y){const g=new FormData;W(m),a.files.forEach((S,c)=>{g.append(`product_request[${y}][]`,S)});const A={id:_.value.id,formData:g};try{const S=await m.dispatch(k.ADD_PRODUCT_REQUEST_DOCUMENTS,A);return n.value=[],O(i,{message:"Documenti aggiunti correttamente.",title:""}),j(m),S}catch(S){j(m),P(i,S)}},formatSize:u,onSelectedFiles:l,confirmDeleteDocument:(a,y)=>{r.require({target:a.currentTarget,message:"Sei sicuro di voler eliminare questo documento?",icon:"pi pi-info-circle",acceptClass:"p-button-danger",accept:()=>{w(y)}})},openDocument:function(a){window.open(a.url,"_blank")}}}},jt={key:0,class:"list-none p-0 mb-4"},Lt=["onClick"],Qt=["onClick"],Yt={key:0,class:"m-0 p-0 list-none"},Bt={class:"flex align-items-center"},Ft=t("br",null,null,-1),zt=["onClick"],Gt=t("div",{class:"text-center"},[t("b",null,"Trascina qui i documenti"),t("p",{class:"text-xs"},"(Dimensione massima 20 MB)")],-1);function Zt(v,o,_,e,i,m){const r=d("FileUpload"),n=d("Card");return p(),I(n,{class:"mt-3"},{content:q(()=>[t("h2",null,E(_.title),1),_.genericDocuments?(p(),b("ul",jt,[(p(!0),b(J,null,K(_.genericDocuments,l=>{var u,w;return p(),b("li",{key:l.id,class:"flex align-items-center mb-3 cursor-pointer"},[t("span",{onClick:T=>e.openDocument(l),class:"flex align-items-center"},[t("i",{class:Q(["pi mr-2",{"pdf-icon":l.url.split(".").pop()=="pdf","pi-images text-xl":(u=l.url.split(".").pop())==null?void 0:u.match(/\jpg|jpeg|png|gif|svg$/i),"document-icon":!((w=l.url.split(".").pop())!=null&&w.match(/\jpg|jpeg|png|gif|svg|pdf$/i))}])},null,2),M(" "+E(l.url.split("/").pop()),1)],8,Lt),t("i",{class:"pi pi-times p-button-icon text-red-600 cursor-pointer font-semibold ml-4",onClick:T=>e.confirmDeleteDocument(T,l.id+"")},null,8,Qt)])}),128))])):D("",!0),s(r,{name:"documents[]",onUploader:o[0]||(o[0]=l=>e.uploadDocuments(l,_.documents_type+"")),multiple:!0,accept:"image/*,.doc,.docx,.pdf,application/msword,application/vnd.openxmlformats-officedocument.wordprocessingml.document",maxFileSize:2e6,customUpload:!0,modelValue:e.documents,"onUpdate:modelValue":o[1]||(o[1]=l=>e.documents=l),onSelect:e.onSelectedFiles},{content:q(()=>[e.documents?(p(),b("ul",Yt,[(p(!0),b(J,null,K(e.documents,(l,u)=>{var w,T;return p(),b("li",{key:l.name,class:"flex align-items-center p-fileupload-file justify-content-between"},[t("div",Bt,[t("i",{class:Q(["pi mr-2",{"pdf-icon":l.name.split(".").pop()=="pdf","pi-images text-xl":(w=l.name.split(".").pop())==null?void 0:w.match(/\jpg|jpeg|png|gif|svg$/i),"document-icon":!((T=l.name.split(".").pop())!=null&&T.match(/\jpg|jpeg|png|gif|svg|pdf$/i))}])},null,2),M(" "+E(l.name),1),Ft,M(" "+E(e.formatSize(l.size)),1)]),t("i",{class:"pi pi-times p-button-icon text-red-600 cursor-pointer font-semibold",onClick:h=>e.onRemoveTempDocument(u,"personal")},null,8,zt)])}),128))])):D("",!0)]),empty:q(()=>[Gt]),_:1},8,["modelValue","onSelect"])]),_:1})}const Ht=B(Mt,[["render",Zt]]),Jt={setup(){const v=U(()=>o.getters[N.CURRENT_PRODUCT_REQUEST]),o=Y();return{product_request:v}},components:{CardProductRequestDetail:ae,CardUploadDocuments:Ht}};function Kt(v,o,_,e,i,m){var l,u,w;const r=d("CardProductRequestDetail"),n=d("CardUploadDocuments");return p(),b("div",null,[s(r),s(n,{title:"DOCUMENTI PERSONALI",genericDocuments:(l=e.product_request)==null?void 0:l.personal_document_attachments,documents_type:"personal_documents"},null,8,["genericDocuments"]),s(n,{title:"DOCUMENTI REDDITUALI",genericDocuments:(u=e.product_request)==null?void 0:u.revenue_document_attachments,documents_type:"revenue_documents"},null,8,["genericDocuments"]),s(n,{title:"DOCUMENTI FINANZIAMENTO EROGATO",genericDocuments:(w=e.product_request)==null?void 0:w.financing_document_attachments,documents_type:"financing_documents"},null,8,["genericDocuments"])])}const Wt=B(Jt,[["render",Kt]]),Xt={setup(){const v=C({icon:"pi pi-home",to:"/pratiche"});fe(()=>{});const o=C([{label:""}]),_=ve(),e=Y(),i=G(),m=C([]),r=C([]),n=C(),l=C(!1),u=C(!1),w=C(!1),T=C(),h=C(),R=U(()=>e.getters[N.CURRENT_PRODUCT_REQUEST]),x=U(()=>e.getters[N.CURRENT_CONTACT_NAME]),a=U(()=>e.getters[N.CURRENT_INIT_PRODUCT_REQUEST]),y=U(()=>e.getters[we.CURRENT_COMPANIES]),g=function(){n.value&&(n.value.contact_birthday=(n==null?void 0:n.value.contact_birthday)!==""?L(n.value.contact_birthday).format("DD/MM/YYYY"):"",n.value.start_at=(n==null?void 0:n.value.start_at)!==""?L(n.value.start_at).format("DD/MM/YYYY"):"",n.value.end_at=(n==null?void 0:n.value.end_at)!==""?L(n.value.end_at).format("DD/MM/YYYY"):"",n.value.contact_first_name?o.value[0]={label:n.value.contact_first_name+" "+n.value.contact_last_name}:o.value[0]={label:n.value.contact_last_name+""}),m.value=["Nessuno","Libero professionista","Indeterminato","Determinato","Apprendistato","Stage"]},A=async function(){try{return await e.dispatch(k.INIT_PRODUCT_REQUEST)}catch(f){P(i,f)}},S=async function(f){const V=new Map;V.set("name",f);try{const F=await e.dispatch(he.FETCH_ALL_COMPANIES,V);return y.value,y.value.companies&&y.value.companies.length==0?h.value=[{name:f,id:null}]:y.value.companies&&(h.value=y.value.companies),F}catch(F){P(i,F)}},c=async function(){try{const f=await e.dispatch(k.PRODUCT_REQUEST_DETAIL,_.params.id+"");return g(),f}catch{}},se=async function(){if(te()){O(i,{message:"Controlla di aver compilato i campi obbligatori.",title:"",error:!0});return}oe(),W(e);let f={product_request:n.value};await e.dispatch(k.CREATE_PRODUCT_REQUEST,f).then(()=>{j(e),O(i,{message:"Pratica creata correttamente.",title:""})}).catch(V=>{j(e),P(i,V)})},X=function(){var f,V;((f=n.value)==null?void 0:f.contact_last_name)==""||((V=n.value)==null?void 0:V.contact_last_name)==null?l.value=!0:l.value=!1},$=function(){var f,V;((f=n.value)==null?void 0:f.contact_first_name)==""||((V=n.value)==null?void 0:V.contact_first_name)==null?w.value=!0:w.value=!1},ee=function(){var f,V;((f=n.value)==null?void 0:f.contact_phone)==""||((V=n.value)==null?void 0:V.contact_phone)==null?u.value=!0:u.value=!1},te=function(){return X(),$(),ee(),l.value||u.value||w.value},oe=function(){n.value&&n.value.company&&n.value.company.id?n.value.company_id=n.value.company.id:n.value&&n.value.company&&n.value.company.id==null&&(n.value.company_name=n.value.company.name)},le=async function(){var V;if(te()||((V=T.value)==null?void 0:V.validateAmount())){O(i,{message:"Controlla di aver compilato i campi obbligatori.",title:"",error:!0});return}W(e),oe();let f={product_request:n.value};await e.dispatch(k.UPDATE_PRODUCT_REQUEST,f).then(()=>{j(e),O(i,{message:"Pratica salvata correttamente.",title:""}),g()}).catch(F=>{j(e),P(i,F)})},ce=f=>{setTimeout(()=>(S(f.query),f.query),250)};return z(x,f=>{f!=null&&f!="undefined undefined"?o.value[0]={label:f+""}:o.value[0]={label:"Nuova pratica"}}),z(R,f=>{n.value=Object.assign({},f),n.value.product_request_status_histories=Object.assign([],f.product_request_status_histories)}),ne(async()=>{_.params.id!=""?c():(n.value={},e.dispatch(k.EMPTY_PRODUCT_REQUEST)),A()}),{home:v,items:o,product_request:R,contract_types:m,new_product_request:n,invalid_last_name:l,invalid_first_name:w,invalid_phone:u,childComponentRef:T,sources:r,initProductRequest:a,resp_companies:y,filteredCompanies:h,createProductRequest:se,updateProductRequest:le,validateLastName:X,validateFirstName:$,validatePhone:ee,searchCompany:ce}},components:{TabInformations:kt,TabDocuments:Wt}};const $t={key:0,class:"product-detail flex m-4 overflow-hidden"},eo={class:"col-4"},to=t("h2",{class:"mt-0 mb-3"},"ANAGRAFICA",-1),oo={class:"formgrid grid"},no={class:"field col-6"},ao=t("label",{for:"contact_last_name"},"Cognome*",-1),so={key:0,id:"contact_last_name",class:"p-error"},lo={class:"field col-6"},co=t("label",{for:"contact_first_name"},"Nome*",-1),io={key:0,id:"contact_first_name",class:"p-error"},ro={class:"field col-6"},_o=t("label",{for:"contact_birthday"},"Data di nascita",-1),uo={class:"field col-6"},mo=t("label",{for:"contact_birth_city"},"Luogo di nascita",-1),po={class:"field col-6"},fo=t("label",{for:"contact_phone"},"Telefono*",-1),vo={key:0,id:"contact_phone",class:"p-error"},ho={class:"field col-6"},wo=t("label",{for:"contact_phone_2_note"},"Note",-1),yo={class:"field col-12"},go=t("label",{for:"contact_email"},"Email",-1),qo={class:"field col-12"},bo=t("label",{for:"contact_job_note"},"Note",-1),To={class:"formgrid grid mt-2 mb-0"},Co={class:"field col-6"},Ro=t("label",{for:"contact_phone_2"},"Telefono 2",-1),Vo={class:"field col-6"},Do=t("label",{for:"contact_phone_2_note"},"Note",-1),Uo={class:"field col-6"},Eo=t("label",{for:"contact_phone_3"},"Telefono 3",-1),xo={class:"field col-6"},So=t("label",{for:"contact_phone_3_note"},"Note",-1),Po={class:"field col-6"},Ao=t("label",{for:"contact_address"},"Indirizzo",-1),Oo={class:"field col-6"},No=t("label",{for:"contact_city"},"Citt\xE0",-1),Io={class:"field col-6"},ko=t("label",{for:"contact_birth_city"},"Provincia",-1),Mo={class:"field col-6"},jo=t("label",{for:"contact_fiscal_code"},"Codice fiscale",-1),Lo=t("h2",{class:"mb-3"},"DATI DI LAVORO",-1),Qo={class:"formgrid grid"},Yo={class:"field col-12"},Bo=t("label",{class:"custom-label"},"Tipo di lavoro",-1),Fo={class:"field col-6"},zo=t("label",{for:"contact_job_start_date"},"Data di assunzione",-1),Go={class:"field col-6"},Zo=t("label",{class:"custom-label"},"Tipo di contratto",-1),Ho=t("h2",{class:"mb-3"},"DATI AZIENDA",-1),Jo={class:"formgrid grid"},Ko={class:"field col-12"},Wo=t("label",null,"Ragione sociale",-1),Xo={class:"company-item"},$o={key:0,class:"ml-2"},en={key:1,class:"text-color-secondary m-0 ml-2 font-medium"},tn={key:0,class:"cols-12"},on={class:"flex flex-wrap"},nn=t("div",{class:"col-6"},"P.IVA:",-1),an={class:"col-6"},sn=t("div",{class:"col-6"},"Referente:",-1),ln={class:"col-6"},cn=t("div",{class:"col-6"},"Email:",-1),dn={class:"col-6"},rn={class:"col-8"},_n={class:"flex justify-content-between align-items-center"};function un(v,o,_,e,i,m){const r=d("InputText"),n=d("InputMask"),l=d("Textarea"),u=d("AccordionTab"),w=d("Accordion"),T=d("Dropdown"),h=d("AutoComplete"),R=d("Card"),x=d("Breadcrumb"),a=d("Button"),y=d("TabInformations"),g=d("TabPanel"),A=d("TabDocuments"),S=d("TabView");return e.new_product_request?(p(),b("div",$t,[t("div",eo,[s(R,null,{content:q(()=>[to,t("div",oo,[t("div",no,[ao,s(r,{class:Q(["w-full",{"p-invalid":e.invalid_last_name}]),id:"contact_last_name",type:"text",modelValue:e.new_product_request.contact_last_name,"onUpdate:modelValue":o[0]||(o[0]=c=>e.new_product_request.contact_last_name=c),"aria-describedby":"contact_last_name",onChange:e.validateLastName},null,8,["modelValue","class","onChange"]),e.invalid_last_name?(p(),b("small",so,"Campo obbligatorio.")):D("",!0)]),t("div",lo,[co,s(r,{class:Q(["w-full",{"p-invalid":e.invalid_first_name}]),id:"contact_first_name",type:"text",modelValue:e.new_product_request.contact_first_name,"onUpdate:modelValue":o[1]||(o[1]=c=>e.new_product_request.contact_first_name=c),onChange:e.validateFirstName},null,8,["modelValue","class","onChange"]),e.invalid_last_name?(p(),b("small",io,"Campo obbligatorio.")):D("",!0)]),t("div",ro,[_o,s(n,{id:"contact_birthday",mask:"99/99/9999",modelValue:e.new_product_request.contact_birthday,"onUpdate:modelValue":o[2]||(o[2]=c=>e.new_product_request.contact_birthday=c),placeholder:"gg/mm/aaaa",slotChar:"gg/mm/aaaa",class:"w-full"},null,8,["modelValue"])]),t("div",uo,[mo,s(r,{class:"w-full",id:"contact_birth_city",type:"text",modelValue:e.new_product_request.contact_birth_city,"onUpdate:modelValue":o[3]||(o[3]=c=>e.new_product_request.contact_birth_city=c)},null,8,["modelValue"])]),t("div",po,[fo,s(r,{class:Q(["w-full",{"p-invalid":e.invalid_phone}]),id:"contact_phone",type:"text",modelValue:e.new_product_request.contact_phone,"onUpdate:modelValue":o[4]||(o[4]=c=>e.new_product_request.contact_phone=c),"aria-describedby":"contact_phone",onChange:e.validatePhone},null,8,["modelValue","class","onChange"]),e.invalid_phone?(p(),b("small",vo,"Campo obbligatorio.")):D("",!0)]),t("div",ho,[wo,s(r,{class:"w-full",id:"contact_phone_2_note",type:"text",modelValue:e.new_product_request.contact_phone_note,"onUpdate:modelValue":o[5]||(o[5]=c=>e.new_product_request.contact_phone_note=c)},null,8,["modelValue"])]),t("div",yo,[go,s(r,{class:"w-full",id:"contact_email",type:"text",modelValue:e.new_product_request.contact_email,"onUpdate:modelValue":o[6]||(o[6]=c=>e.new_product_request.contact_email=c)},null,8,["modelValue"])]),t("div",qo,[bo,s(l,{modelValue:e.new_product_request.contact_job_note,"onUpdate:modelValue":o[7]||(o[7]=c=>e.new_product_request.contact_job_note=c),rows:"5",cols:"30",class:"w-full"},null,8,["modelValue"])])]),s(w,{class:"m-0"},{default:q(()=>[s(u,{header:"ALTRI DATI"},{default:q(()=>[t("div",To,[t("div",Co,[Ro,s(r,{class:"w-full",id:"contact_phone_2",type:"text",modelValue:e.new_product_request.contact_phone_2,"onUpdate:modelValue":o[8]||(o[8]=c=>e.new_product_request.contact_phone_2=c)},null,8,["modelValue"])]),t("div",Vo,[Do,s(r,{class:"w-full",id:"contact_phone_2_note",type:"text",modelValue:e.new_product_request.contact_phone_2_note,"onUpdate:modelValue":o[9]||(o[9]=c=>e.new_product_request.contact_phone_2_note=c)},null,8,["modelValue"])]),t("div",Uo,[Eo,s(r,{class:"w-full",id:"contact_phone_3",type:"text",modelValue:e.new_product_request.contact_phone_3,"onUpdate:modelValue":o[10]||(o[10]=c=>e.new_product_request.contact_phone_3=c)},null,8,["modelValue"])]),t("div",xo,[So,s(r,{class:"w-full",id:"contact_phone_3_note",type:"text",modelValue:e.new_product_request.contact_phone_3_note,"onUpdate:modelValue":o[11]||(o[11]=c=>e.new_product_request.contact_phone_3_note=c)},null,8,["modelValue"])]),t("div",Po,[Ao,s(r,{class:"w-full",id:"contact_address",type:"text",modelValue:e.new_product_request.contact_address,"onUpdate:modelValue":o[12]||(o[12]=c=>e.new_product_request.contact_address=c)},null,8,["modelValue"])]),t("div",Oo,[No,s(r,{class:"w-full",id:"contact_city",type:"text",modelValue:e.new_product_request.contact_city,"onUpdate:modelValue":o[13]||(o[13]=c=>e.new_product_request.contact_city=c)},null,8,["modelValue"])]),t("div",Io,[ko,s(r,{class:"w-full",id:"contact_birth_city",type:"text",modelValue:e.new_product_request.contact_province,"onUpdate:modelValue":o[14]||(o[14]=c=>e.new_product_request.contact_province=c)},null,8,["modelValue"])]),t("div",Mo,[jo,s(r,{class:"w-full",id:"contact_fiscal_code",type:"text",modelValue:e.new_product_request.contact_fiscal_code,"onUpdate:modelValue":o[15]||(o[15]=c=>e.new_product_request.contact_fiscal_code=c)},null,8,["modelValue"])])])]),_:1})]),_:1}),Lo,t("div",Qo,[t("div",Yo,[Bo,s(T,{modelValue:e.new_product_request.contact_job_type,"onUpdate:modelValue":o[16]||(o[16]=c=>e.new_product_request.contact_job_type=c),options:e.initProductRequest.job_types,id:"contact_job_type",class:"w-full"},null,8,["modelValue","options"])]),t("div",Fo,[zo,s(n,{id:"contact_job_start_date",mask:"99/99/9999",modelValue:e.new_product_request.contact_job_start_date,"onUpdate:modelValue":o[17]||(o[17]=c=>e.new_product_request.contact_job_start_date=c),placeholder:"gg/mm/aaaa",slotChar:"gg/mm/aaaa",class:"w-full"},null,8,["modelValue"])]),t("div",Go,[Zo,s(T,{modelValue:e.new_product_request.contact_contract_type,"onUpdate:modelValue":o[18]||(o[18]=c=>e.new_product_request.contact_contract_type=c),options:e.contract_types,class:"w-full"},null,8,["modelValue","options"])])]),Ho,t("div",Jo,[t("div",Ko,[Wo,s(h,{class:"w-full",modelValue:e.new_product_request.company,"onUpdate:modelValue":o[19]||(o[19]=c=>e.new_product_request.company=c),suggestions:e.filteredCompanies,onComplete:o[20]||(o[20]=c=>e.searchCompany(c)),emptySearchMessage:"Nessun risultato",emptySelectionMessage:"Nessun risultato",optionLabel:"name"},{item:q(c=>[t("div",Xo,[c.item.id!=null?(p(),b("div",$o,E(c.item.name),1)):(p(),b("p",en," + Crea nuova ragione sociale "+E(c.item.name),1))])]),_:1},8,["modelValue","suggestions"])])]),e.new_product_request.company&&e.new_product_request.company.id?(p(),b("div",tn,[s(R,{class:"surface-200"},{content:q(()=>[t("div",on,[nn,t("div",an,E(e.new_product_request.company.vat||"-"),1),sn,t("div",ln,E(e.new_product_request.company.referral_user||"-"),1),cn,t("div",dn,E(e.new_product_request.company.email||"-"),1)])]),_:1})])):D("",!0)]),_:1})]),t("div",rn,[t("div",_n,[s(x,{home:e.home,model:e.items},null,8,["home","model"]),e.new_product_request.id?(p(),I(a,{key:0,label:"Salva pratica",onClick:e.updateProductRequest},null,8,["onClick"])):(p(),I(a,{key:1,label:"Salva pratica",onClick:e.createProductRequest},null,8,["onClick"]))]),s(S,{class:"mt-2"},{default:q(()=>[s(g,{header:"INFORMAZIONI",disabled:!e.new_product_request.id},{default:q(()=>[s(y,{initProductRequest:e.initProductRequest,modelValue:e.new_product_request,"onUpdate:modelValue":o[21]||(o[21]=c=>e.new_product_request=c),ref:"childComponentRef"},null,8,["initProductRequest","modelValue"])]),_:1},8,["disabled"]),s(g,{header:"DOCUMENTI",disabled:!e.new_product_request.id},{default:q(()=>[s(A)]),_:1},8,["disabled"]),s(g,{header:"EMAIL",disabled:!e.new_product_request.id},null,8,["disabled"]),s(g,{header:"SMS",disabled:!e.new_product_request.id},null,8,["disabled"])]),_:1})])])):D("",!0)}const vn=B(Xt,[["render",un]]);export{vn as default};
