import{q as u,a0 as k,u as B,I as q,g as U,h as D,s as g,aa as I,R as E,l as _,K as C,W as b,a8 as L,X as P,_ as Q,d as x,b as m,w as O,r as p,o as A,a as c,L as y,e as z}from"../index25247.js";const G={setup(){const R=u({icon:"pi pi-home",to:"/stati-pratica"}),n=u(""),v=u([{label:""}]),t=k(),e=B(),l=q(),a=u({}),r=u(!1),i=u(!1),S=U(()=>e.getters[L.CURRENT_USER]),f=U(()=>e.getters[P.CURRENT_REQUEST_STATUSES]),d=async function(){try{return await e.dispatch(b.FETCH_ALL_PRODUCTS_REQUEST)}catch(o){_(e),C(l,o)}},w=async function(){if(T()||h())return;g(e);const o={user:a.value};try{const s=await e.dispatch(I.UPDATE_USER,o);return E(l,{message:"Utente aggiornato correttamente.",title:""}),_(e),s}catch(s){_(e),C(l,s)}},V=async function(){if(T(),h(),r.value||i.value){E(l,{message:"Controlla di aver compilato i campi obbligatori.",title:"",error:!0});return}g(e);const o={request_status:{name:a.value.name,parent_id:a.value.parent_id}};try{const s=await e.dispatch(b.CREATE_REQUEST_STATUS,o);return E(l,{message:"Stato pratica creato correttamente.",title:""}),_(e),s}catch(s){_(e),C(l,s)}},N=function(){n.value!=""&&a.value.id?w():V()},T=function(){var o,s;return((o=a.value)==null?void 0:o.parent_id)==""||((s=a.value)==null?void 0:s.parent_id)==null?r.value=!0:r.value=!1,r.value},h=function(){return a.value.name==""||a.value.name==null?i.value=!0:i.value=!1,i.value};return D(async()=>{n.value=t.params.id+"",d(),v.value[0]={label:"Nuovo stato pratica"}}),{user_detail:S,home:R,items:v,tmp_status:a,invalid_parent_id:r,invalid_status:i,request_statuses:f,saveStatus:N,validateParentStatus:T,validateStatus:h}}};const j={class:"m-4"},F={class:"flex align-items-center justify-content-between"},H=c("h1",null,"STATO PRATICA",-1),K={class:"formgrid grid col-6 flex flex-column"},M={class:"field col-6 flex flex-column"},W=c("label",{for:"parent_id"},"Macro stato*",-1),X={class:"field col-6"},J=c("label",{for:"name"},"Stato pratica*",-1),Y={key:0,id:"name",class:"p-error"};function Z(R,n,v,t,e,l){const a=p("Breadcrumb"),r=p("Button"),i=p("Dropdown"),S=p("InputText"),f=p("Card");return A(),x("div",j,[m(a,{home:t.home,model:t.items},null,8,["home","model"]),m(f,null,{content:O(()=>[c("div",F,[H,m(r,{label:"Salva stato pratica",onClick:t.saveStatus},null,8,["onClick"])]),c("div",K,[c("div",M,[W,m(i,{options:t.request_statuses,id:"parent_id",class:y(["p-column-filter",{"p-invalid":t.invalid_parent_id}]),optionLabel:"name",optionValue:"id",placeholder:"Seleziona il macro stato",modelValue:t.tmp_status.parent_id,"onUpdate:modelValue":n[0]||(n[0]=d=>t.tmp_status.parent_id=d),onChange:t.validateParentStatus},null,8,["options","modelValue","onChange","class"])]),c("div",X,[J,m(S,{id:"name",type:"text",modelValue:t.tmp_status.name,"onUpdate:modelValue":n[1]||(n[1]=d=>t.tmp_status.name=d),class:y(["w-full",{"p-invalid":t.invalid_status}]),onChange:t.validateStatus},null,8,["modelValue","class","onChange"]),t.invalid_status?(A(),x("small",Y,"Campo obbligatorio.")):z("",!0)])])]),_:1})])}const tt=Q(G,[["render",Z]]);export{tt as default};
